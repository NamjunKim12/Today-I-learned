## 📌 이터러블

### 📌 이터러블이란?

- `ES6` 에서 도입된 순회 가능한 자료구조를 만들기 위해 정의한 규칙을 `이터레이션 프로토콜`이라고 부름.
- 이터레이션 프로토콜의 하위 프로토콜로는 `이터러블 프로토콜`과 `이터레이터 프로토콜`이 있음.
- `이터러블 프로토콜`은 `Symbol.iterator` 메서드를 통해 이터레이터 프로토콜을 준수하는 이터레이터를 반환하는 규칙을 말함. 
- `이터레이터 프로토콜`은 `Symbol.iterator` 메서드 호출시 `next` 메서드를 통해 이터러블을 순회하며 `value, done` 프로퍼티를 갖는 객체를 반환하는 규칙을 말함.
- 이터러블 프로토콜을 준수한 순회가능한 자료구조를 `이터러블`이라고하고, 이터러블의 요소를 탐색하기 위한 포인터 역할을 하는 객체를 `이터레이터`라고 함.

### 📌 이터러블과 유사 배열 객체

- `유사 배열 객체`는 인덱스로 프로퍼티 값에 접근할 수 있고,`length` 프로퍼티를 갖는 객체를 말함.
- 이런 특성을 통해 배열처럼 인덱스로 프로퍼티 값에 접근할 수 있음. 
- 유사배열 객체는 원칙적으로는 **이터러블이 아니기 때문에**, `for...of` 문으로 순회할 수 없음.
- 하지만 유사배열 객체이면서 이터러블인 객체도 존재하는데, `arguments, DOM NodeList, DOM HTMLCollection` 가 대표적임. 
- 위 객체들은 `Symbol.iterator` 메서드를 갖고 있어 이터러블 프로토콜을 준수하고 있어, `for...of` 문으로 순회할 수 있음.

### 📌 이터레이션 프로토콜의 필요성

- ES6 이전에는 순회 가능한 자료구조들이 통일된 규약 없이 `for 문, for ~ in문, forEach` 등 각자의 방식으로 순회할 수 있었음.
- ES6 에서는 모든 순회 가능한 자료구조를 이터레이션 프로토콜을 준수하는 `이터러블`로 통일하여 `Symbol.iterator` 메서드를 구현한 이터러블을 통해 순회함. 
- 모든 이터러블들은 공통된 규약 덕분에 `스프레드 문법, 배열 구조분해할당, for...of` 문 등을 사용 가능함.
- `for ~ of, 스프레드 문법, 배열 구조분해할당` 같은 데이터 소비자와 `Array, String, Map/Set, DOM Collection` 같은 데이터 생산자를 분리함으로써 **데이터 생산자와 소비자의 역할을 명확히 분리할 수 있게 됨.** 
- 이런 인터페이스 역할을 하는 공통된 규약을 통해 순회 가능한 자료구조들을 통일하고, 순회 가능한 자료구조들을 순회하는 방식을 통일함으로써 자바스크립트의 유연함을 유지하면서도 일관성을 유지할 수 있게 됨.

### 📌 사용자 정의 이터러블 구현하기

- 빌트인 심벌 뿐만 아니라 이터레이션 프로토콜을 준수하지 않는 일반 객체도 아래처럼 이터레이션 프로토콜을 준수하도록 구현할 수 있음.

```js 
const fibonacci = {
    [Symbol.iterator]() {
        let [pre, cur] = [0, 1];
        const max = 10;

        return {
            next() {
                [pre, cur] = [cur, pre + cur];
                return { value: cur, done: cur >= max };
            }
        }
    }
}

for (const num of fibonacci) {
    console.log(num); // 1 2 3 5 8
}

```