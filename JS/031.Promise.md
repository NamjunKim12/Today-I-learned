## 📌 프로미스

- 자바스크립트는 원래 비동기 처리를 위한 하나의 패턴으로 `콜백 패턴`을 사용함.
- 하지만 전통적인 콜백 패턴은 비동기 처리 중 발생한 에러를 캐치하기 어렵고, 여러 개의 비동기 처리 로직을 한 번에 처리하기도 어려움.
- 이러한 콜백 패턴의 단점을 보완하기 위해 ES6에서는 `프로미스`를 도입함.

### 📌 프로미스의 생성

- Promise 생성자 함수를 new 연산자와 함께 호출하면 프로미스 인스턴스를 생성할 수 있음.
- Promise 생성자 함수는 비동기 작업을 수행할 콜백 함수를 인자로 전달받음.

```js
const promise = new Promise((resolve, reject) => {
  // 비동기 작업을 수행한다.
  // ...
  if (/* 비동기 작업 수행 성공 */) {
    resolve('result');
  } else { /* 비동기 작업 수행 실패 */
    reject('failure reason');
  }
});
```

- Promise 생성자 함수는 인수로 전달받은 콜백 함수 내부에서 비동기 처리를 수행함.
- 이때 비동기 처리가 성공하면 콜백 함수의 인수로 전달받은 `resolve` 함수를 호출하고, 실패하면 `reject` 함수를 호출함.
- 프로미스는 비동기 처리가 성공하거나 실패하면 상태(state)가 변경됨.
- 프로미스의 상태는 `대기(pending)`, `이행(fulfilled)`, `거부(rejected)` 세 가지 중 하나임.
- 생성된 직후의 프로미스 객체의 상태는 대기 상태(pending)이고, 성공 상태는 이행(fulfilled), 실패 상태는 거부(rejected)임.
- 이행된 상태는 `settled` 상태라고도 부름.
- 즉 Promise는 비동기 처리 상태와 처리 결과를 관리하는 객체임.

### 📌 프로미스의 후속 처리 메서드

- `then`, `catch`, `finally` 후속 처리 메서드는 프로미스의 상태가 변화했을 때 호출되는 콜백 함수를 인수로 전달받음.
- then은 성공시 후속처리, catch는 실패시 후속처리, finally는 성공/실패시 후속처리를 모두 수행함.

### 📌 프로미스의 에러 처리

- 프로미스의 에러 처리는 프로미스의 실패시 후속 처리 메서드인 `catch` 메서드를 사용함.

### 📌 프로미스의 정적 메서드

- `resolve` 정적 메서드는 인수로 전달받은 값을 갖는 `fulfilled` 상태인 프로미스를 생성함.
- `rejected` 정적 메서드는 인수로 전달받은 값을 갖는 `rejected` 상태인 프로미스를 생성함.
- `all`, `race`, `allSettled` 정적 메서드는 여러 개의 프로미스를 생성함.
- `all`은 여러개의 비동기 처리를 모두 병렬 처리할 때 사용함. 모든 비동기 처리가 성공하면 `fulfilled` 상태인 프로미스를 반환하고, 하나라도 실패하면 `rejected` 상태인 프로미스를 반환함. 모든 비동기 처리가 성공해야만 하는 경우에 사용함.
- `race`는 여러 개의 비동기 처리 중 가장 먼저 종료된 비동기 처리 결과를 반환함. 가장 먼저 종료된 비동기 처리 결과가 성공이면 `fulfilled` 상태인 프로미스를 반환하고, 성공하는 프로미스가 하나도 없으면 `rejected` 상태인 프로미스를 반환함. 여러 개의 비동기 처리 중 가장 먼저 종료되는 비동기 처리 결과만 필요한 경우에 사용함.
- `allSettled`는 여러 개의 비동기 처리를 모두 병렬 처리할 때 사용함. 모든 비동기 처리가 종료되면 `fulfilled` 상태인 프로미스를 반환함. 모든 비동기 처리가 종료되어야만 하는 경우에 사용함.

### 📌 마이크로태스크 큐

- 프로미스의 후속 처리 메서드는 비동기 처리 결과를 후속 처리하는 콜백 함수를 비동기 처리 방식으로 호출함.
- 이때 비동기 처리 방식으로 호출된 콜백 함수는 `마이크로태스크 큐`에 저장됨.
- 마이크로태스크큐는 태스크 큐와는 별도의 큐로, **프로미스 후속처리 메서드의 콜백함수가 저장**되는 큐임.
- 후속처리 메서드를 제외한 그 외의 비동기 처리 콜백 함수는 태스크 큐에 저장됨.

### 📌 fetch 

- `fetch` 함수는 HTTP 통신을 위한 `XMLHttpRequest` 객체의 대체제임.
- fetch 함수는 HTTP 응답을 나타내는 Response 객체를 래핑한 Promise 객체를 반환함.
- 첫번째 인수로는 요청을 보낼 URL을, 두번째 인수로는 HTTP 요청 메서드, 헤더, 페이로드 등을 설정한 객체를 전달함. 
- fetch 함수가 반환하는 프로미스는 404, 500 같은 HTTP 에러가 발생해도 이를 검출하지 못하고, ok상태를 false로 설정하고 resolve함.
- 따라서 fetch 함수를 사용할 때는 HTTP 응답 상태를 검사하여 별도로 에러를 처리해줄 필요가 있음.
- 이런 fetch 함수의 단점을 보완하기 위해 axios 라이브러리를 사용함. axios 등은 모든 에러를 reject하는 프로미스를 반환할뿐만 아니라, 인터셉터, 요청 설정 등 fetch 보다 더 많은 기능을 제공함.

